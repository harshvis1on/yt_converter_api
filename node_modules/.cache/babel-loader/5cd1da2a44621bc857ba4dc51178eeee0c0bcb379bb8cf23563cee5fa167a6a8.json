{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { episodeService } from '../services/episodeService';\nexport function useEpisodes(megaphoneId) {\n  _s();\n  const [state, setState] = useState({\n    loading: false,\n    error: null,\n    episodes: [],\n    totalCount: 0,\n    n8nEpisodes: [] // Track n8n episodes separately\n  });\n  useEffect(() => {\n    if (megaphoneId) {\n      loadEpisodes();\n    }\n  }, [megaphoneId]);\n  const loadEpisodes = async () => {\n    try {\n      setState(s => ({\n        ...s,\n        loading: true,\n        error: null\n      }));\n      console.log('📻 Loading episodes from Supabase for Megaphone ID:', megaphoneId);\n\n      // First get the podcast ID from the megaphone ID\n      const podcastId = await episodeService.getPodcastIdFromMegaphoneId(megaphoneId);\n      if (!podcastId) {\n        throw new Error('Podcast not found in database');\n      }\n\n      // Then get episodes from Supabase\n      const result = await episodeService.getEpisodesFromSupabase(podcastId);\n      if (result.success) {\n        let transformedEpisodes = episodeService.transformEpisodeData(result.episodes);\n\n        // Enrich episodes with Megaphone API status if we have the podcast Megaphone ID\n        try {\n          console.log('🎧 Attempting to enrich episodes with Megaphone status...');\n          transformedEpisodes = await episodeService.enrichEpisodesWithMegaphoneStatus(transformedEpisodes, megaphoneId);\n          console.log('✅ Episodes enriched with Megaphone status');\n        } catch (enrichError) {\n          console.warn('⚠️ Failed to enrich episodes with Megaphone status:', enrichError);\n          // Continue with non-enriched episodes\n        }\n        setState(s => ({\n          ...s,\n          episodes: transformedEpisodes,\n          totalCount: result.totalCount,\n          loading: false\n        }));\n        console.log(`✅ Loaded ${transformedEpisodes.length} episodes from Supabase`);\n      } else {\n        throw new Error(result.error || 'Failed to load episodes');\n      }\n    } catch (error) {\n      console.error('❌ Failed to load episodes:', error);\n      setState(s => ({\n        ...s,\n        error: error.message,\n        loading: false,\n        episodes: [],\n        totalCount: 0\n      }));\n    }\n  };\n  const refreshEpisodes = async () => {\n    if (megaphoneId) {\n      await loadEpisodes();\n    }\n  };\n\n  // Add newly created episodes from n8n workflow results\n  const addN8nEpisodes = (n8nResults, originalVideoData = null) => {\n    console.log('📺 Adding n8n episodes to display:', n8nResults);\n    if (!n8nResults || !Array.isArray(n8nResults)) {\n      console.warn('Invalid n8n results provided:', n8nResults);\n      return;\n    }\n\n    // Transform n8n data for display, optionally with original video data for better titles\n    const transformedN8nEpisodes = episodeService.transformN8nEpisodeData(n8nResults, originalVideoData);\n    setState(s => {\n      // Remove any existing n8n episodes with same IDs to avoid duplicates\n      const existingEpisodes = s.episodes.filter(ep => ep.source !== 'n8n');\n      const combinedEpisodes = [...transformedN8nEpisodes, ...existingEpisodes];\n      console.log(`✅ Added ${transformedN8nEpisodes.length} n8n episodes to display`);\n      return {\n        ...s,\n        episodes: combinedEpisodes,\n        n8nEpisodes: transformedN8nEpisodes,\n        totalCount: combinedEpisodes.length\n      };\n    });\n\n    // Refresh from Supabase after a delay to get the persisted data\n    setTimeout(() => {\n      console.log('🔄 Refreshing episodes from Supabase after n8n creation...');\n      refreshEpisodes();\n    }, 3000);\n  };\n\n  // Clear n8n episodes (when they've been persisted to Supabase)\n  const clearN8nEpisodes = () => {\n    setState(s => ({\n      ...s,\n      n8nEpisodes: [],\n      episodes: s.episodes.filter(ep => ep.source !== 'n8n')\n    }));\n  };\n  return {\n    ...state,\n    refreshEpisodes,\n    addN8nEpisodes,\n    clearN8nEpisodes\n  };\n}\n_s(useEpisodes, \"lQQLJ/8lL6T0PT/shlfZISENTmw=\");","map":{"version":3,"names":["useState","useEffect","episodeService","useEpisodes","megaphoneId","_s","state","setState","loading","error","episodes","totalCount","n8nEpisodes","loadEpisodes","s","console","log","podcastId","getPodcastIdFromMegaphoneId","Error","result","getEpisodesFromSupabase","success","transformedEpisodes","transformEpisodeData","enrichEpisodesWithMegaphoneStatus","enrichError","warn","length","message","refreshEpisodes","addN8nEpisodes","n8nResults","originalVideoData","Array","isArray","transformedN8nEpisodes","transformN8nEpisodeData","existingEpisodes","filter","ep","source","combinedEpisodes","setTimeout","clearN8nEpisodes"],"sources":["/Users/harshdeshmukh/YouTube To Mp4 Links/src/hooks/useEpisodes.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { episodeService } from '../services/episodeService';\n\nexport function useEpisodes(megaphoneId) {\n  const [state, setState] = useState({\n    loading: false,\n    error: null,\n    episodes: [],\n    totalCount: 0,\n    n8nEpisodes: [] // Track n8n episodes separately\n  });\n\n  useEffect(() => {\n    if (megaphoneId) {\n      loadEpisodes();\n    }\n  }, [megaphoneId]);\n\n  const loadEpisodes = async () => {\n    try {\n      setState(s => ({ ...s, loading: true, error: null }));\n      \n      console.log('📻 Loading episodes from Supabase for Megaphone ID:', megaphoneId);\n      \n      // First get the podcast ID from the megaphone ID\n      const podcastId = await episodeService.getPodcastIdFromMegaphoneId(megaphoneId);\n      if (!podcastId) {\n        throw new Error('Podcast not found in database');\n      }\n\n      // Then get episodes from Supabase\n      const result = await episodeService.getEpisodesFromSupabase(podcastId);\n      \n      if (result.success) {\n        let transformedEpisodes = episodeService.transformEpisodeData(result.episodes);\n        \n        // Enrich episodes with Megaphone API status if we have the podcast Megaphone ID\n        try {\n          console.log('🎧 Attempting to enrich episodes with Megaphone status...');\n          transformedEpisodes = await episodeService.enrichEpisodesWithMegaphoneStatus(transformedEpisodes, megaphoneId);\n          console.log('✅ Episodes enriched with Megaphone status');\n        } catch (enrichError) {\n          console.warn('⚠️ Failed to enrich episodes with Megaphone status:', enrichError);\n          // Continue with non-enriched episodes\n        }\n        \n        setState(s => ({ \n          ...s, \n          episodes: transformedEpisodes, \n          totalCount: result.totalCount,\n          loading: false \n        }));\n        console.log(`✅ Loaded ${transformedEpisodes.length} episodes from Supabase`);\n      } else {\n        throw new Error(result.error || 'Failed to load episodes');\n      }\n    } catch (error) {\n      console.error('❌ Failed to load episodes:', error);\n      setState(s => ({ \n        ...s, \n        error: error.message, \n        loading: false,\n        episodes: [],\n        totalCount: 0\n      }));\n    }\n  };\n\n  const refreshEpisodes = async () => {\n    if (megaphoneId) {\n      await loadEpisodes();\n    }\n  };\n\n  // Add newly created episodes from n8n workflow results\n  const addN8nEpisodes = (n8nResults, originalVideoData = null) => {\n    console.log('📺 Adding n8n episodes to display:', n8nResults);\n    \n    if (!n8nResults || !Array.isArray(n8nResults)) {\n      console.warn('Invalid n8n results provided:', n8nResults);\n      return;\n    }\n\n    // Transform n8n data for display, optionally with original video data for better titles\n    const transformedN8nEpisodes = episodeService.transformN8nEpisodeData(n8nResults, originalVideoData);\n    \n    setState(s => {\n      // Remove any existing n8n episodes with same IDs to avoid duplicates\n      const existingEpisodes = s.episodes.filter(ep => ep.source !== 'n8n');\n      const combinedEpisodes = [...transformedN8nEpisodes, ...existingEpisodes];\n      \n      console.log(`✅ Added ${transformedN8nEpisodes.length} n8n episodes to display`);\n      \n      return {\n        ...s,\n        episodes: combinedEpisodes,\n        n8nEpisodes: transformedN8nEpisodes,\n        totalCount: combinedEpisodes.length\n      };\n    });\n\n    // Refresh from Supabase after a delay to get the persisted data\n    setTimeout(() => {\n      console.log('🔄 Refreshing episodes from Supabase after n8n creation...');\n      refreshEpisodes();\n    }, 3000);\n  };\n\n  // Clear n8n episodes (when they've been persisted to Supabase)\n  const clearN8nEpisodes = () => {\n    setState(s => ({\n      ...s,\n      n8nEpisodes: [],\n      episodes: s.episodes.filter(ep => ep.source !== 'n8n')\n    }));\n  };\n\n  return {\n    ...state,\n    refreshEpisodes,\n    addN8nEpisodes,\n    clearN8nEpisodes\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}